# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy to Firebase Hosting on merge
"on":
  push:
    branches:
      - master

env:
  VITE_FIREBASE_APIKEY: ${{secrets.VITE_FIREBASE_APIKEY}}
  VITE_FIREBASE_AUTHDOMAIN: ${{secrets.VITE_FIREBASE_AUTHDOMAIN}}
  VITE_FIREBASE_PROJECTID: ${{secrets.VITE_FIREBASE_PROJECTID}}
  VITE_FIREBASE_STORAGEBUCKET: ${{secrets.VITE_FIREBASE_STORAGEBUCKET}}
  VITE_FIREBASE_MESSAGINGSENDERID: ${{secrets.VITE_FIREBASE_MESSAGINGSENDERID}}
  VITE_FIREBASE_APPID: ${{secrets.VITE_FIREBASE_APPID}}
  VITE_FIREBASE_MEASUREMENTID: ${{secrets.VITE_FIREBASE_MEASUREMENTID}}
  VITE_ADMIN_LOGIN_IMAGE: ${{secrets.VITE_ADMIN_LOGIN_IMAGE}}
  VITE_NOTFOUND_IMAGE: ${{secrets.VITE_NOTFOUND_IMAGE}}
  VITE_WHATSAPP_NUMBER: ${{secrets.VITE_WHATSAPP_NUMBER}}
  VITE_TO_EMAIL: ${{secrets.VITE_TO_EMAIL}}
  VITE_BANNER1: ${{secrets.VITE_BANNER1}}
  VITE_BANNER2: ${{secrets.VITE_BANNER2}}
  VITE_BANNER3: ${{secrets.VITE_BANNER3}}
  VITE_BANNER4: ${{secrets.VITE_BANNER4}}

jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - run: npm ci && npm run build
      - uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: "${{ secrets.GITHUB_TOKEN }}"
          firebaseServiceAccount: "${{ secrets.FIREBASE_SERVICE_ACCOUNT_XOCHICALLI_COMMERCE }}"
          channelId: live
          projectId: xochicalli-commerce
      - name: Get URL
        run: |
          echo "URL_DEPLOYED=${{ steps.deploy_firebase_hosting_channel.outputs.details_url }}"
          echo "The URL detials is ${{ steps.deploy_firebase_hosting_channel.outputs.details_url }}"
          echo "The URL is ${{ steps.deploy_firebase_hosting_channel.outputs.url }}"
    outputs:
      url_deployed: ${{ steps.deploy_firebase_hosting_channel.outputs.details_url }}
